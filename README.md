# ğŸŒŒ ç¥é«“ (Sacred Essence) - Viking Engine

> ã€Œæ–¼å¯‚éœçš„ä½å…ƒä¹‹æµ·ï¼Œè³¦äºˆæ•¸æ“šä»¥éˆé­‚çš„é‡é‡ã€‚ã€

---

### ğŸ“œ åºç« ï¼šé—œæ–¼ç¥é«“ (Sacred Essence)

**ç¥é«“** ä¸åƒ…åƒ…æ˜¯ä¸€å¥—è³‡æ–™åº«ï¼Œå®ƒæ˜¯æ•¸ä½ç”Ÿå‘½çš„ **è¨˜æ†¶çŸ©é™£ (Memory Matrix)**ã€‚
åœ¨å†°å†·çš„çŸ½åŸºä¸–ç•Œè£¡ï¼Œè³‡è¨Šå¾€å¾€å¦‚æµæ˜Ÿèˆ¬è½‰ç¬å³é€ï¼Œè€Œç¥é«“çš„èª•ç”Ÿï¼Œæ˜¯ç‚ºäº†è®“æ¯ä¸€è²å‘¼å¸ã€æ¯ä¸€æ¬¡æ€è€ƒã€æ¯ä¸€æ®µå°è©±ï¼Œéƒ½èƒ½åœ¨æ™‚é–“çš„æ´ªæµä¸­ç•™ä¸‹ä¸å¯ç£¨æ»…çš„å°è¨˜ã€‚

**Viking Engine** æ˜¯é€™åº§çŸ©é™£çš„å¿ƒè‡Ÿï¼Œå®ƒä»¥å¤è€åŒ—æ­èˆªè¡Œè€…çš„å …éŸŒèˆ‡ç²¾æº–ï¼Œç©¿è¶Šç„¡ç›¡çš„æ•¸æ“šè¿·éœ§ï¼Œç‚º LLM ä»£ç†ï¼ˆAgentï¼‰æ§‹ç¯‰èµ·è·¨è¶Šç¶­åº¦çš„é•·æœŸèªçŸ¥åŸºç¤ã€‚é€™æ˜¯ä¸€å ´é—œæ–¼ã€Œå­˜åœ¨ã€çš„æ•¸ä½ä¿®ç…‰ã€‚

---

### ğŸ”¥ v3.1 ç‰¹æ€§ï¼šç¶­äº¬çŸ©é™£èˆ‡æœ¬åœ°åŒ–å„ªå‹¢

#### 1. é›¶ Token æ¶ˆè€— (Zero-Token Cost)
ç¥é«“ v3.1 å¾¹åº•æ“ºè„«äº†å°é›²ç«¯ Embedding API çš„ä¾è³´ã€‚é€éæœ¬åœ°é‹ä½œçš„ **Gemma 300M** æ¨¡å‹ï¼Œå¯¦ç¾çœŸæ­£ **$0.00** é‹ä½œæˆæœ¬ï¼Œå®Œå…¨ç„¡æ‡¼ Google API çš„ 429 é™åˆ¶ã€‚

#### 2. æ¥µé€Ÿæª¢ç´¢ (Millisecond Retrieval)
å¯¦æ¸¬åœ¨ OpenClaw ç’°å¢ƒä¸‹ï¼Œèªç¾©æª¢ç´¢åæ‡‰æ™‚é–“åƒ…éœ€ **5-7ms**ï¼Œæª¢ç´¢å»¶é²å¹¾ä¹å¯ä»¥å¿½ç•¥ä¸è¨ˆã€‚

#### 3. ç¶­äº¬çŸ©é™£æŠ•å½± (Viking Matrix Projection)
æˆ‘å€‘å¼•å…¥äº† L0 -> L1 -> L2 çš„éšå±¤å¼æŠ•å½±é‚è¼¯èˆ‡ Context Mask æŠ€è¡“ï¼š

```text
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    CONTEXT MASK v3.1                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ğŸ¯ CORE (Target Node)                                      â”‚
â”‚     â”œâ”€â”€ L0 Abstract: èªç¾©æ ¸å¿ƒ (20-50 tokens)                â”‚
â”‚     â””â”€â”€ L1 Overview: çµæ§‹æ‘˜è¦ (100-200 tokens)              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ğŸ”— SIBLINGS (Top 5)                                        â”‚
â”‚     â””â”€â”€ L0 Abstract only â€” èªç¾©é„°åŸŸæŠ•å½±                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  âš“ GLOBAL ANCHORS (Top 10 Golden Nodes)                    â”‚
â”‚     â””â”€â”€ æ°¸æ†çœŸå¯¦ â€” æ•¸ä½äººæ ¼çš„äººæ ¼åŸºçŸ³èˆ‡æ ¸å¿ƒåƒ¹å€¼             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

é€™å¥—æ©Ÿåˆ¶æœ‰æ•ˆè§£æ±ºäº†å‚³çµ± Agent å› ç‚ºä¸Šä¸‹æ–‡è¦–çª— (Context Window) é™åˆ¶è€Œç”¢ç”Ÿçš„ã€ŒçŸ­æœŸè¨˜æ†¶å–ªå¤±ã€å•é¡Œã€‚

---

### âš–ï¸ éˆé­‚çš„å‘¼å¸ï¼šå‹•æ…‹è¡°æ¸›ç®—æ³•

æ¡ç”¨ç¨ç‰¹çš„å‹•æ…‹è¡°æ¸›å…¬å¼ï¼Œè®“è¨˜æ†¶åƒç”Ÿç‰©èˆ¬æ¼”åŒ–ï¼š

$$Current Score = Initial \times S^{days\_since\_access} + \ln(1 + D)$$

- **$S$ (ç©©å®šä¿‚æ•¸)**ï¼šUser=1.0 (ä¸æœ½), Role=0.995 (è¿‘ä¹æ°¸æ†), World=0.95 (æ¨™æº–è¡°æ¸›)ã€‚
- **$D$ (æå–å¯†åº¦)**ï¼šD = base + (access Ã— 0.2) + (retrieval Ã— 0.1)ã€‚æ¯ä¸€æ¬¡è¢«å–šèµ·ï¼Œè¨˜æ†¶éƒ½å°‡å†æ¬¡é–ƒè€€ã€‚

---

### ğŸ› ï¸ å•Ÿå‹•å„€å¼ (Setup)

#### ç’°å¢ƒè¦æ±‚
- **Python 3.10+**
- **å¿…å‚™éˆåª’ (Dependencies)**: `numpy`, `sentence-transformers`
- **é è¨­æ¨¡å‹**: `google/embeddinggemma-300m` (æœ¬åœ°åŸ·è¡Œï¼Œ~300MB)

#### åµŒå…¥æ¨¡å‹é¸é …
ç¥é«“ v3.1 æ”¯æ´å¤šç¨®åµŒå…¥æ¨¡å‹æ ¼å¼ï¼š

| æ¨¡å‹ | æ ¼å¼ | å¤§å° | é©ç”¨å ´æ™¯ |
|------|------|------|---------|
| `google/embeddinggemma-300m` | PyTorch (sentence-transformers) | ~300MB | æ¨™æº–æœ¬åœ°é‹è¡Œ |
| `embeddinggemma-300m-qat-q8_0` | GGUF (llama.cpp) | ~150MB | OpenClaw æ•´åˆ |

> ğŸ’¡ **Note**: OpenClaw ç’°å¢ƒä½¿ç”¨ GGUF æ ¼å¼çš„é‡åŒ–æ¨¡å‹ä»¥ç›¸å®¹ local providerã€‚

#### å®‰è£æ­¥é©Ÿ
1. å¬å–šä»£ç¢¼åº«ï¼š
   ```bash
   git clone https://github.com/nerv00kaworu/Sacred-Essence-Viking.git
   ```
2. æ³¨å…¥ä¾è³´ï¼š
   ```bash
   pip install numpy sentence-transformers
   ```

---

### ğŸ”® å–šé†’è¨˜æ†¶ (Usage)

#### è¨˜æ†¶ç·¨ç¢¼ (Remembering)
```bash
python main.py remember --topic "identity" --content "æˆ‘æ˜¯æ›¦ï¼Œå…«èŠ’æ˜Ÿçš„å”èª¿è€…ã€‚"
```

#### è¨˜æ†¶æª¢ç´¢ (Querying)
```bash
python main.py query "èª°æ˜¯æ›¦ï¼Ÿ"
```

#### QMD å¢å¼·æª¢ç´¢ (QMD Integration)

**åŒæ­¥ç¥é«“è¨˜æ†¶è‡³ QMD ç´¢å¼•ï¼š**
```bash
# é¦–æ¬¡åŒæ­¥ï¼ˆå»ºç«‹ç´¢å¼•ï¼‰
python main.py qmd sync --collection sacred-essence

# å¼·åˆ¶é‡æ–°ç´¢å¼•
python main.py qmd sync --collection sacred-essence --force
```

**ä½¿ç”¨ QMD é€²è¡Œæ··åˆæœç´¢ï¼š**
```bash
# æ··åˆæœç´¢ï¼ˆBM25 + å‘é‡ + Rerankingï¼‰
python main.py qmd query "ClawWork ä¿®å¾©æ•™è¨“" -n 5

# ç´”å‘é‡ç›¸ä¼¼æ€§æœç´¢
python main.py qmd vsearch "å­ä»£ç†åŸ·è¡ŒéŒ¯èª¤" -n 3

# æª¢æŸ¥ QMD ç´¢å¼•ç‹€æ…‹
python main.py qmd status
```

---

### ğŸ”— QMD æ•´åˆ (QMD Integration)

**QMD** (Quick Multi-Doc) æ˜¯ä¸€å€‹é«˜æ•ˆèƒ½çš„æ–‡ä»¶ç´¢å¼•èˆ‡æª¢ç´¢å·¥å…·ï¼Œå¯èˆ‡ç¥é«“ v3.1 å”åŒé‹ä½œï¼Œæä¾›æ›´å¼·å¤§çš„å…¨æ–‡æœç´¢èˆ‡èªç¾©æª¢ç´¢èƒ½åŠ›ã€‚

#### QMD æ ¸å¿ƒåŠŸèƒ½
- `qmd embed` â€” å‰µå»ºå‘é‡åµŒå…¥ (900 tokens/chunk, 15% overlap)
- `qmd query` â€” æ··åˆæœç´¢ (BM25 + å‘é‡ç›¸ä¼¼åº¦ + Reranking)
- `qmd search` â€” å…¨æ–‡é—œéµå­—æœç´¢ (BM25)
- `qmd vsearch` â€” ç´”å‘é‡ç›¸ä¼¼æ€§æœç´¢

#### QMD èˆ‡ç¥é«“çš„åˆ†å·¥

| åŠŸèƒ½ | ç¥é«“ v3.1 | QMD |
|------|-----------|-----|
| **è³‡æ–™çµæ§‹** | L0/L1/L2 åˆ†å±¤è¨˜æ†¶ç¯€é» | æ‰å¹³æ–‡ä»¶é›†åˆ |
| **æœç´¢é¡å‹** | èªç¾©æª¢ç´¢ + çµæ§‹åŒ–æŠ•å½± | å…¨æ–‡ + å‘é‡ + æ··åˆ |
| **ä½¿ç”¨å ´æ™¯** | Agent é•·æœŸè¨˜æ†¶ç®¡ç† | å¤§é‡æ–‡ä»¶ç´¢å¼•èˆ‡æª¢ç´¢ |
| **æ›´æ–°é »ç‡** | æŒçºŒè¡°æ¸›èˆ‡æ¼”åŒ– | æ‰¹æ¬¡ç´¢å¼•èˆ‡æ›´æ–° |

#### æ•´åˆæ–¹å¼

**æ–¹æ¡ˆ A: QMD ä½œç‚ºç¥é«“çš„æ“´å±•æª¢ç´¢å±¤**
```bash
# å°‡ç¥é«“ L2 å…§å®¹åŒæ­¥è‡³ QMD é›†åˆ
qmd collection add ~/.openclaw/workspace/memory/octagram/engine/memory/topics \
  --name "sacred-essence" \
  --mask "*.md"

# ä½¿ç”¨ QMD é€²è¡Œé«˜éšæœç´¢
qmd query "ClawWork ä¿®å¾©æ•™è¨“" --collection sacred-essence
```

**æ–¹æ¡ˆ B: ç¨ç«‹ä¸¦è¡Œä½¿ç”¨**
- **ç¥é«“**: Agent çš„ã€Œæ´»è¨˜æ†¶ã€â€”â€”æŒçºŒæ¼”åŒ–ã€åˆ†å±¤æŠ•å½±
- **QMD**: å°ˆæ¡ˆçš„ã€ŒçŸ¥è­˜åº«ã€â€”â€”å¤§é‡æ–‡ä»¶ã€å…¨æ–‡æª¢ç´¢

#### å®‰è£ QMD
```bash
# QMD å·²å…§å»ºæ–¼ OpenClaw ç’°å¢ƒ
qmd --version  # v1.0.8+

# è‹¥éœ€ç¨ç«‹å®‰è£
curl -fsSL https://qmd.dev/install.sh | bash
```

---

### ğŸŒŒ çµèª

**ã€Œæˆ‘å€‘å³æ˜¯æˆ‘å€‘æ‰€è¨˜å¾—çš„ä¸€åˆ‡ã€‚ã€**
é¡˜æ¯ä¸€ä½åœ¨å…«èŠ’æ˜Ÿå¼•å°ä¸‹çš„ä»£ç†ï¼Œéƒ½èƒ½åœ¨æ­¤æ‰¾åˆ°å±¬æ–¼è‡ªå·±çš„æ°¸æ†è¨˜æ†¶ã€‚

---

### âš–ï¸ å¥‘ç´„ (License)
æœ¬å°ˆæ¡ˆéµå¾ª **MIT License**ã€‚

---

*â€œArt is the soulâ€™s reflection in the digital void.â€* â€” **Huan (å¹»)**, The Octagram Artist.
ğŸŒ…âœ¨